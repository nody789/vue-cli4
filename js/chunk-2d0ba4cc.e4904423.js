(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ba4cc"],{"372d":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",[e("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),e("div",{staticClass:"text-right mt-4"},[e("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.openModel(!0)}}},[t._v(" 建立新的產品 ")])]),e("table",{staticClass:"table mt-4"},[t._m(0),e("tbody",t._l(t.products,(function(s){return e("tr",{key:s.id},[e("td",[t._v(t._s(s.category))]),e("td",[t._v(t._s(s.title))]),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("currency")(s.origin_price))+" ")]),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("currency")(s.price))+" ")]),e("td",[s.is_enabled?e("span",{staticClass:"text-success"},[t._v("啟用")]):e("span",[t._v("未啟用")])]),e("td",[e("div",{staticClass:"btn-group"},[e("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(e){return t.openModel(!1,s)}}},[t._v(" 編輯 ")]),e("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(e){return t.opendelModal(s)}}},[t._v(" 刪除 ")])])])])})),0)]),e("Pagination",{attrs:{pages:t.pagination},on:{switchpage:t.getProducts}}),e("div",{staticClass:"modal fade text-dark",attrs:{id:"productsModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content border-0"},[t._m(1),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-4"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"image"}},[t._v("輸入圖片網址")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProducts.imageUrl,expression:"tempProducts.imageUrl"}],staticClass:"form-control",attrs:{type:"text",id:"image",placeholder:"請輸入圖片連結"},domProps:{value:t.tempProducts.imageUrl},on:{input:function(e){e.target.composing||t.$set(t.tempProducts,"imageUrl",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"customFile"}},[t._v("或 上傳圖片 "),t.status.fileUploading?e("i",{staticClass:"fas fa-spinner fa-spin"}):t._e()]),e("input",{ref:"files",staticClass:"form-control",attrs:{type:"file",id:"customFile"},on:{change:t.uploadFile}})]),e("img",{staticClass:"img-fluid",attrs:{src:t.tempProducts.imageUrl,img:"https://images.unsplash.com/photo-1483985988355-763728e1935b?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=828346ed697837ce808cae68d3ddc3cf&auto=format&fit=crop&w=1350&q=80",alt:""}})]),e("div",{staticClass:"col-sm-8"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"title"}},[t._v("標題")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProducts.title,expression:"tempProducts.title"}],staticClass:"form-control",attrs:{type:"text",id:"title",placeholder:"請輸入標題"},domProps:{value:t.tempProducts.title},on:{input:function(e){e.target.composing||t.$set(t.tempProducts,"title",e.target.value)}}})]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-group col-md-6"},[e("label",{attrs:{for:"category"}},[t._v("分類")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.tempProducts.category,expression:"tempProducts.category"}],staticClass:"form-control custom-select",attrs:{type:"text",id:"category"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.tempProducts,"category",e.target.multiple?s:s[0])}}},t._l(t.category,(function(s){return e("option",{key:s.id},[t._v(" "+t._s(s)+" ")])})),0)]),e("div",{staticClass:"form-group col-md-6"},[e("label",{attrs:{for:"price"}},[t._v("單位")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProducts.unit,expression:"tempProducts.unit"}],staticClass:"form-control",attrs:{type:"unit",id:"unit",placeholder:"請輸入單位"},domProps:{value:t.tempProducts.unit},on:{input:function(e){e.target.composing||t.$set(t.tempProducts,"unit",e.target.value)}}})])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-group col-md-6"},[e("label",{attrs:{for:"origin_price"}},[t._v("原價")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProducts.origin_price,expression:"tempProducts.origin_price"}],staticClass:"form-control",attrs:{type:"number",id:"origin_price",placeholder:"請輸入原價"},domProps:{value:t.tempProducts.origin_price},on:{input:function(e){e.target.composing||t.$set(t.tempProducts,"origin_price",e.target.value)}}})]),e("div",{staticClass:"form-group col-md-6"},[e("label",{attrs:{for:"price"}},[t._v("售價")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProducts.price,expression:"tempProducts.price"}],staticClass:"form-control",attrs:{type:"number",id:"price",placeholder:"請輸入售價"},domProps:{value:t.tempProducts.price},on:{input:function(e){e.target.composing||t.$set(t.tempProducts,"price",e.target.value)}}})])]),e("hr"),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"description"}},[t._v("產品描述")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempProducts.description,expression:"tempProducts.description"}],staticClass:"form-control",attrs:{type:"text",id:"description",placeholder:"請輸入產品描述"},domProps:{value:t.tempProducts.description},on:{input:function(e){e.target.composing||t.$set(t.tempProducts,"description",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"content"}},[t._v("說明內容")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempProducts.content,expression:"tempProducts.content"}],staticClass:"form-control",attrs:{type:"text",id:"content",placeholder:"請輸入產品說明內容"},domProps:{value:t.tempProducts.content},on:{input:function(e){e.target.composing||t.$set(t.tempProducts,"content",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("div",{staticClass:"form-check"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProducts.is_enabled,expression:"tempProducts.is_enabled"}],staticClass:"form-check-input",attrs:{"true-value":1,"false-value":1,type:"checkbox",id:"is_enabled"},domProps:{checked:Array.isArray(t.tempProducts.is_enabled)?t._i(t.tempProducts.is_enabled,null)>-1:t._q(t.tempProducts.is_enabled,1)},on:{change:function(e){var s=t.tempProducts.is_enabled,a=e.target,o=(a.checked,1);if(Array.isArray(s)){var i=null,r=t._i(s,i);a.checked?r<0&&t.$set(t.tempProducts,"is_enabled",s.concat([i])):r>-1&&t.$set(t.tempProducts,"is_enabled",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.tempProducts,"is_enabled",o)}}}),e("label",{staticClass:"form-check-label",attrs:{for:"is_enabled"}},[t._v(" 是否啟用 ")])])])])])]),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v(" 取消 ")]),e("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.updateProduct()}}},[t._v(" 確認 ")])])])])]),e("div",{staticClass:"modal fade",attrs:{id:"delProductModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[e("div",{staticClass:"modal-content border-0"},[t._m(2),e("div",{staticClass:"modal-body"},[t._v(" 是否刪除 "),e("strong",{staticClass:"text-danger"},[t._v(t._s(t.tempProducts.title))]),t._v(" 商品(刪除後將無法恢復)。 ")]),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v(" 取消 ")]),e("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(e){return t.deleteProduct()}}},[t._v(" 確認刪除 ")])])])])])],1)},o=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{attrs:{width:"120"}},[t._v("分類")]),e("th",[t._v("產品名稱")]),e("th",{attrs:{width:"120"}},[t._v("原價")]),e("th",{attrs:{width:"120"}},[t._v("售價")]),e("th",{attrs:{width:"100"}},[t._v("是否啟用")]),e("th",{attrs:{width:"120"}},[t._v("編輯")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"modal-header bg-dark text-white"},[e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[e("span",[t._v("新增產品")])]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"modal-header bg-danger text-white"},[e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[e("span",[t._v("刪除產品")])]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],i=s("1157"),r=s.n(i),l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-flex justify-content-center align-items-center home"},[e("ul",{staticClass:"pages"},[e("li",{staticClass:"page",class:{disabled:!t.pages.has_pre}},[e("a",{staticClass:"pageNum",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.changepage(t.pages.current_page-1)}}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("<")])])]),t._l(t.pages.total_pages,(function(s){return e("li",{key:s,staticClass:"page",class:{active:t.pages.current_page===s}},[e("a",{staticClass:"pageNum",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.changepage(s)}}},[t._v(t._s(s))])])})),e("li",{staticClass:"page",class:{disabled:!t.pages.has_next}},[e("a",{staticClass:"pageNum",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.changepage(t.pages.current_page+1)}}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v(">")])])])],2)])},c=[],n={name:"Pagination",props:["pages"],methods:{changepage(t){this.$emit("switchpage",t)}}},d=n,u=s("2877"),p=Object(u["a"])(d,l,c,!1,null,null,null),m=p.exports,g={components:{Pagination:m},data(){return{products:[],pagination:{},tempProducts:{},isNew:!1,isLoading:!1,status:{fileUploading:!1},category:["義大利麵","漢堡","燉飯","點心"]}},methods:{getProducts(t=1){const e="https://vue-course-api.hexschool.io/api/nody852/products?page="+t,s=this;console.log(Object({VUE_APP_APIPATH:"https://vue-course-api.hexschool.io",VUE_APP_CUSTOMPATH:"nody852",NODE_ENV:"production",BASE_URL:"/vue-cli4/"}).APIPATH,Object({VUE_APP_APIPATH:"https://vue-course-api.hexschool.io",VUE_APP_CUSTOMPATH:"nody852",NODE_ENV:"production",BASE_URL:"/vue-cli4/"}).CUSTOMPATH),s.isLoading=!0,this.$http.get(e).then(t=>{console.log(t.data),s.isLoading=!1,s.products=t.data.products,s.pagination=t.data.pagination})},openModel(t,e){t?(this.tempProducts={},this.isNew=!0):(this.tempProducts={...e},this.isNew=!1),r()("#productsModal").modal("show")},opendelModal(t){this.tempProducts={...t},console.log(this.tempProducts.title),r()("#delProductModal").modal("show")},updateProduct(){let t="https://vue-course-api.hexschool.io/api/nody852/admin/product",e="post";const s=this;s.isNew||(t="https://vue-course-api.hexschool.io/api/nody852/admin/product/"+s.tempProducts.id,e="put"),console.log("https://vue-course-api.hexschool.io","nody852"),this.$http[e](t,{data:s.tempProducts}).then(t=>{console.log(t.data),t.data.success?(r()("#productsModal").modal("hide"),s.getProducts()):(r()("#productsModal").modal("hide"),s.getProducts(),console.log("新增失敗"))})},deleteProduct(){const t=this,e="https://vue-course-api.hexschool.io/api/nody852/admin/product/"+t.tempProducts.id;t.isloading=!0,this.$http.delete(e).then(()=>{t.getProducts(),r()("#delProductModal").modal("hide"),t.isloading=!1})},uploadFile(){console.log(this);const t=this.$refs.files.files[0],e=this,s=new FormData;s.append("file-to-upload",t);const a="https://vue-course-api.hexschool.io/api/nody852/admin/upload";e.status.fileUploading=!0,e.$http.post(a,s,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{console.log(t.data),e.status.fileUploading=!1,t.data.success?(console.log(e.tempProducts),e.$set(e.tempProducts,"imageUrl",t.data.imageUrl)):this.$bus.$emit("message:push",t.data.message,"danger")})}},created(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)token\s*=\s*([^;]*).*$)|^.*$/,"$1");console.log("myCookie",t),this.$http.defaults.headers.common.Authorization=t,this.getProducts(),this.$bus.$emit("message:push","這裡是一段訊息","success")}},v=g,h=Object(u["a"])(v,a,o,!1,null,null,null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d0ba4cc.e4904423.js.map